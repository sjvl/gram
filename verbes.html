<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu des verbes conjugu√©s</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .instructions {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .instructions p {
            color: #555;
            line-height: 1.6;
        }

        #startBtn, #finishBtn {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        #startBtn:hover, #finishBtn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        #gameArea {
            display: none;
        }

        .phrase {
            background: #f9f9f9;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            line-height: 1.6;
            font-size: 1.05em;
            text-align: left;
            word-spacing: normal;
        }

        .word {
            cursor: pointer;
            transition: all 0.1s;
            display: inline;
            white-space: normal;
            -webkit-tap-highlight-color: transparent;
            position: relative;
        }
        
        .word:active {
            background: transparent;
        }

        .word.selected {
            background: #667eea;
            color: white;
            box-shadow: 0 0 0 3px #667eea;
            border-radius: 2px;
        }

        .word.correct {
            background: #10b981;
            color: white;
            box-shadow: 0 0 0 3px #10b981;
            border-radius: 2px;
        }

        .word.incorrect {
            background: #ef4444;
            color: white;
            box-shadow: 0 0 0 3px #ef4444;
            border-radius: 2px;
        }

        #finishBtn {
            display: none;
            background: #10b981;
        }

        #finishBtn:hover {
            background: #059669;
        }

        #result {
            display: none;
            text-align: center;
            margin-top: 30px;
        }

        #result h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
        }

        #score {
            font-size: 3em;
            color: #10b981;
            font-weight: bold;
            margin: 20px 0;
        }

        #restartBtn {
            margin-top: 20px;
            padding: 15px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        #restartBtn:hover {
            background: #5568d3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Jeu des verbes conjugu√©s</h1>
        
        <div id="welcome">
            <div class="instructions">
                <p><strong>R√®gle du jeu :</strong></p>
                <p>Trouvez les 10 verbes conjugu√©s dans les phrases pr√©sent√©es.</p>
                <p>Cliquez sur les mots que vous pensez √™tre des verbes conjugu√©s.</p>
                <p>Cliquez sur "Termin√©" quand vous avez fini !</p>
            </div>
            <button id="startBtn">Jouer</button>
        </div>

        <div id="gameArea">
            <div id="phrases"></div>
            <button id="finishBtn">Termin√©</button>
        </div>

        <div id="result">
            <h2>R√©sultat</h2>
            <div id="score"></div>
            <p id="message"></p>
            <button id="restartBtn">Rejouer</button>
        </div>
    </div>

    <script>
        let selectedWords = [];
        let gameData = [];
        let allPhrases = [];

        // G√©n√©rateur de phrases avec analyse automatique des verbes
        function generatePhrases() {
            const phrases = [
                "Le soleil brille dans le ciel bleu et r√©chauffe la terre.",
                "Marie court rapidement vers l'√©cole car elle est en retard.",
                "Les oiseaux chantent doucement dans les arbres du jardin.",
                "Mon petit fr√®re dessine un ch√¢teau sur sa feuille blanche.",
                "Papa pr√©pare le d√Æner pendant que maman lit un livre.",
                "Les enfants jouent au ballon dans la cour de r√©cr√©ation.",
                "Le chat dort paisiblement sur le canap√© du salon.",
                "Grand-m√®re raconte une belle histoire avant le coucher.",
                "Nous partons en vacances demain matin tr√®s t√¥t.",
                "Les fleurs poussent rapidement gr√¢ce √† la pluie.",
                "Jules apprend sa le√ßon de g√©ographie pour demain.",
                "Le train arrive √† la gare √† huit heures pr√©cises.",
                "Sophie range sa chambre tous les samedis matin.",
                "Les √©toiles brillent dans le ciel de la nuit.",
                "Mon chien aboie quand quelqu'un sonne √† la porte.",
                "Lucas finit ses devoirs avant d'aller jouer dehors.",
                "Maman arrose les plantes du balcon chaque jour.",
                "Le boulanger fait du pain frais tous les matins.",
                "Emma cherche son jouet pr√©f√©r√© dans toute la maison.",
                "Les vagues viennent l√©cher le sable de la plage.",
                "Thomas mange une pomme rouge √† la r√©cr√©ation.",
                "La pluie tombe doucement sur les toits des maisons.",
                "Les √©l√®ves √©coutent attentivement les explications du professeur.",
                "Le vent souffle fort et fait tomber les feuilles.",
                "L√©a aide sa petite s≈ìur √† mettre ses chaussures.",
                "Le fermier nourrit ses animaux dans la grange.",
                "Nous regardons un film amusant en famille ce soir.",
                "Les papillons volent de fleur en fleur dans le jardin.",
                "Paul √©crit une lettre √† son correspondant italien.",
                "La neige recouvre la montagne d'un manteau blanc."
            ];

            // Mots qui sont typiquement des verbes conjugu√©s (SANS les infinitifs)
            const verbPatterns = [
                'brille', 'r√©chauffe', 'court', 'est', 'chantent', 'dessine', 'pr√©pare', 
                'lit', 'jouent', 'dort', 'raconte', 'partons', 'poussent', 'apprend',
                'arrive', 'range', 'brillent', 'aboie', 'sonne', 'finit',
                'arrose', 'fait', 'cherche', 'viennent', 'mange', 'tombe',
                '√©coutent', 'souffle', 'aide', 'nourrit', 'regardons',
                'volent', '√©crit', 'recouvre', 'vais', 'vas', 'va', 'allons', 'allez', 'vont',
                'suis', 'es', 'sommes', '√™tes', 'sont', 'ai', 'as', 'avons', 'avez', 'ont'
            ];

            return phrases.map(phrase => {
                const words = phrase.split(' ');
                const verbs = [];
                
                words.forEach((word, index) => {
                    // Nettoyer le mot de la ponctuation pour la comparaison
                    const cleanWord = word.replace(/[.,!?;:]/g, '').toLowerCase();
                    if (verbPatterns.includes(cleanWord)) {
                        verbs.push(index);
                    }
                });

                return {
                    text: phrase,
                    verbs: verbs
                };
            });
        }

        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('finishBtn').addEventListener('click', finishGame);
        document.getElementById('restartBtn').addEventListener('click', resetGame);

        function startGame() {
            document.getElementById('welcome').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
            
            // G√©n√©rer toutes les phrases si ce n'est pas d√©j√† fait
            if (allPhrases.length === 0) {
                allPhrases = generatePhrases();
            }
            
            // M√©langer et s√©lectionner des phrases qui ont au moins 1 verbe
            const validPhrases = allPhrases.filter(p => p.verbs.length > 0);
            const shuffled = [...validPhrases].sort(() => Math.random() - 0.5);
            
            // S√©lectionner jusqu'√† avoir exactement 10 verbes
            gameData = [];
            let totalVerbs = 0;
            
            for (let phrase of shuffled) {
                if (totalVerbs >= 10) break;
                gameData.push(phrase);
                totalVerbs += phrase.verbs.length;
            }
            
            // Ajuster si on a trop de verbes
            if (totalVerbs > 10) {
                let excess = totalVerbs - 10;
                for (let i = gameData.length - 1; i >= 0 && excess > 0; i--) {
                    if (gameData[i].verbs.length > 1) {
                        gameData[i].verbs.pop();
                        excess--;
                    }
                }
            }
            
            displayPhrases();
            document.getElementById('finishBtn').style.display = 'block';
        }

        function displayPhrases() {
            const phrasesContainer = document.getElementById('phrases');
            phrasesContainer.innerHTML = '';
            
            gameData.forEach((phrase, phraseIndex) => {
                const phraseDiv = document.createElement('div');
                phraseDiv.className = 'phrase';
                
                const words = phrase.text.split(' ');
                
                // Cr√©er le texte comme un flux continu
                words.forEach((word, wordIndex) => {
                    const wordSpan = document.createElement('span');
                    wordSpan.className = 'word';
                    wordSpan.textContent = word;
                    wordSpan.dataset.phraseIndex = phraseIndex;
                    wordSpan.dataset.wordIndex = wordIndex;
                    wordSpan.dataset.isVerb = phrase.verbs.includes(wordIndex) ? 'true' : 'false';
                    
                    wordSpan.addEventListener('click', toggleWord);
                    phraseDiv.appendChild(wordSpan);
                    
                    // Ajouter un espace apr√®s chaque mot sauf le dernier
                    if (wordIndex < words.length - 1) {
                        phraseDiv.appendChild(document.createTextNode(' '));
                    }
                });
                
                phrasesContainer.appendChild(phraseDiv);
            });
        }

        function toggleWord(e) {
            e.preventDefault();
            const word = e.target;
            const key = `${word.dataset.phraseIndex}-${word.dataset.wordIndex}`;
            
            if (word.classList.contains('selected')) {
                word.classList.remove('selected');
                selectedWords = selectedWords.filter(w => w !== key);
            } else {
                word.classList.add('selected');
                selectedWords.push(key);
            }
        }

        function finishGame() {
            let correct = 0;
            let total = 0;
            
            // Calculer le score
            gameData.forEach((phrase, phraseIndex) => {
                phrase.verbs.forEach(verbIndex => {
                    total++;
                    const key = `${phraseIndex}-${verbIndex}`;
                    if (selectedWords.includes(key)) {
                        correct++;
                    }
                });
            });
            
            // Marquer les mots
            document.querySelectorAll('.word').forEach(word => {
                const key = `${word.dataset.phraseIndex}-${word.dataset.wordIndex}`;
                const isVerb = word.dataset.isVerb === 'true';
                const isSelected = selectedWords.includes(key);
                
                word.style.pointerEvents = 'none';
                word.classList.remove('selected');
                
                if (isVerb && isSelected) {
                    word.classList.add('correct');
                } else if (!isVerb && isSelected) {
                    word.classList.add('incorrect');
                } else if (isVerb && !isSelected) {
                    word.style.opacity = '0.5';
                    word.style.textDecoration = 'underline';
                }
            });
            
            // Afficher le r√©sultat
            document.getElementById('finishBtn').style.display = 'none';
            showResult(correct, total);
        }

        function showResult(correct, total) {
            const percentage = Math.round((correct / total) * 100);
            
            document.getElementById('score').textContent = `${correct}/${total} (${percentage}%)`;
            
            let message = '';
            if (percentage === 100) {
                message = 'üéâ Parfait ! Vous √™tes un expert en grammaire !';
            } else if (percentage >= 80) {
                message = 'üëè Excellent travail ! Vous ma√Ætrisez bien les verbes !';
            } else if (percentage >= 60) {
                message = 'üëç Bien jou√© ! Continuez √† vous entra√Æner !';
            } else {
                message = 'üí™ Continuez vos efforts, vous progresserez !';
            }
            
            document.getElementById('message').textContent = message;
            document.getElementById('result').style.display = 'block';
        }

        function resetGame() {
            selectedWords = [];
            gameData = [];
            document.getElementById('result').style.display = 'none';
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('welcome').style.display = 'block';
        }
    </script>
</body>
</html>